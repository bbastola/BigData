Spark Use case:

We all know that it was 4 way contest at the time of 2014 General elections between BJP, BSP, INC and SP.Now UP State elections are underway and it is 3 way contest between BJP, BSP and SP+INC. Let us analyse how many seats each party would have won if it was 3 way contest instead.
Note: Data contains header

1. import org.apache.spark.{SparkConf, SparkContext}
2. val conf = new SparkConf().setAppName("Vote calculation").setMaster("local")
3. val sc = new SparkContext(conf)
4. val electionData = sc.textFile("/Users/bbastola/Documents/Github/Dataset/electionresults")
5. val electionDataNoHeader = electionData.mapPartitionsWithIndex((idx, iter) => if(idx == 0) iter.drop(1) else iter)
6. val electionDataUP = electionDataNoHeader.filter(rec => rec.contains("Uttar Pradesh"))
7. val filteredUP = electionDataUP.map(rec => {
     | val r = rec.split("\t")
     | ((r(0), r(1)),(r(6), r(8).toInt))
     | })
//the transformation done on 7 will generate (state, constituencey) as key and (party, vote) as value

8. val filteredUPAlly = filteredUP.map(rec => {
	if(rec._2._1 == "SP" || rec._2._1 == "INC")
	(rec._1, ("Ally", rec._2._2))
	else
	rec
}) 

9. val filteredUPAllygBK = filteredUPAlly.groupByKey()




