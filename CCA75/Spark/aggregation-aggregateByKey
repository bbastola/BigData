This is used when combiner(intermediate) logic and reducer(final) logic are different

it takes 3 arguments: aggregateByKey(initialization value, lambda, lambda)

//Get Revenue and count of items for each order_id

orderItems = sc.textFile("/public/retail_db/order_items")
orderItemsMap = orderItems.map(lambda rec: (int(rec.split(",")[1]), float(rec.split(",")[4])))
orderItemsAggregateByKey = orderItemsMap.aggregateByKey((0.0, 0), lambda x,y: (x[0] + y, x[1] + 1) , lambda x,y: (x[0] + y[0], x[1] + y[1]))


