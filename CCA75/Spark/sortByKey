//sort data by product price 

products = sc.textFile("/public/retail_db/products")
productsMap = products.map(lambda rec: (float(rec.split(",")[4]), rec))
productsSort = productsMap.sortByKey()
--This returned an error " ValueError: could not convert string to float:"
there is a empty value on price field so we have to filter it first

productsFilter = products.filter(lambda rec: rec.split(",")[4] != "")
productsMap = productsFilter.map(lambda rec: (float(rec.split(",")[4]), rec))
productsSort = productsMap.sortByKey()
productsSortFinal = productsSort.map(lambda rec: rec[1])


//sort data by product category and then product price descending
products = sc.textFile("/public/retail_db/products")
productsFilter = products.filter(lambda rec: rec.split(",")[4] != "")
productsFilterMap = productsFilter.map(lambda rec: ((int(rec.split(",")[1]), -float(rec.split(",")[4])), rec))   --> - float --> - will give sort data in decending order
productsSorted = productsFilterMap.sortByKey().map(lambda rec: rec[1])
for i in productsSorted.take(25): print i


