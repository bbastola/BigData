orderItems = sc.textFile("/public/retail_db/order_items")
orderItemsMap = orderItems.map(lambda rec: (int(rec.split(",")[1]), float(rec.split(",")[4])))
from operator import add
orderItemsReduceByKey = orderItemsMap.reduceByKey(add).map(lambda rec: ("Order id: " + str(rec[0])) + "\t" + "Subtotal: " + str(rec[1])).saveAsTextFile("/user/bbastola/orderItemsSubtotal.txt")

//saving with compression

orderItemsReduceByKey = orderItemsMap.reduceByKey(add).map(lambda rec: ("Order id: " + str(rec[0])) + "\t" + "Subtotal: " + str(rec[1])).saveAsTextFile("/user/bbastola/orderItemsSubtotal.txt",
compressionCodecClass="org.apache.hadoop.io.compress.SnappyCodec")


