//Get revenue for each order_id - reduceByKey

orderItems = sc.textFile("/public/retail_db/order_items")
orderItemsMap = orderItems.map(lambda rec: (int(rec.split(",")[1]), float(rec.split(",")[4])))
orderItemsReduceByKey = orderItemsMap.reduceByKey(lambda x, y: round((x + y), 2))
for i in orderItemsReduceByKey.take(10): print i

OR we can reduce using another way

from operator import add
orderItemsReduceByKey = orderItemsMap.reduceByKey(add)





