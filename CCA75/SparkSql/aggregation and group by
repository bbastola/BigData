//find number of orders in each order_status

select order_status, count(*) as order_count from orders group by order_status;

//revenue for each order
select order_item_order_id, sum(order_item_subtotal) from order_items group by order_item_order_id;

select order_id, order_date, order_status, round(sum(order_item_subtotal), 2)
from orders o join order_items oi on o.order_id = oi.order_item_order_id
group by order_id, order_date, order_status limit 20;

//completed orders that generates revenue for that $1000
select order_id, order_date, order_status, round(sum(order_item_subtotal), 2) as total_revenue
from orders o join order_items oi on o.order_id = oi.order_item_order_id
where o.order_status in ('COMPLETE', 'CLOSED')
group by order_id, order_date, order_status
having round(sum(order_item_subtotal), 2) > 1000;

//revenue for each date (Complete and closed)
select order_date, round(sum(order_item_subtotal), 2)
from orders o join order_items oi on o.order_id = oi.order_item_order_id
where order_status in ('COMPLETE', 'CLOSED')
group by order_date;
