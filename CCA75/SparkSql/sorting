
//completed orders that generates revenue for that $1000 and sort by date ascending order, revenue descending order

select order_id, order_date, order_status, round(sum(order_item_subtotal), 2) as total_revenue
from orders o join order_items oi on o.order_id = oi.order_item_order_id
where o.order_status in ('COMPLETE', 'CLOSED')
group by order_id, order_date, order_status
having round(sum(order_item_subtotal), 2) > 1000
order by order_date, total_revenue desc;

//using distribute by with sort by 
select order_id, order_date, order_status, round(sum(order_item_subtotal), 2) as total_revenue
from orders o join order_items oi on o.order_id = oi.order_item_order_id
where o.order_status in ('COMPLETE', 'CLOSED')
group by order_id, order_date, order_status
having round(sum(order_item_subtotal), 2) > 1000
distribute by order_date sort by order_date, total_revenue desc;