Problem Statement:

Compute average revenue per day
Get completed orders
Join orders and order_items and get required fields to compute average revenue
Divide the revenue per day with number of unique orders per day to get average revenue
Hint: You need to use combination of map, reduceByKey/aggregateByKey, join to get the final result

ordersRDD = sc.textFile("/public/retail_db/orders")
order_itemsRDD = sc.textFile("/public/retail_db/order_items")

ordersFilter = ordersRDD.filter(lambda r: r.split(",")[3] == 'COMPLETE')

ordersMap = ordersFilter.map(lambda r: (int(r.split(",")[0]), r.split(",")[1]))
orderItemsMap = order_itemsRDD.map(lambda r: (int(r.split(",")[1]), float(r.split(",")[4])))

ordersJoinOrderItems = ordersMap.join(orderItemsMap).map(lambda r: (r[1][0][:10], r[1][1]))

dailyRevenueAvg = ordersJoinOrderItems.aggregateByKey((0.0, 0), lambda x, y: (x[0] + y, x[1] + 1),lambda x,y: ((x[0]+y[0])/x[1]+y[1],\ x[1]+y[1])) 


