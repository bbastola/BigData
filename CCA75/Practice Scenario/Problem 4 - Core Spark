Details - Duration 10 minutes

Data is available in local file system under /data/nyse (ls -ltr /data/nyse)
Fields (stockticker:string, transactiondate:string, openprice:float, highprice:float, lowprice:float, closeprice:float, volume:bigint)

Convert file format to parquet
Save it /user/<YOUR_USER_ID>/nyse_parquet
Validation

hadoop fs -copyFromLocal /data/nyse /user/bbastola/

nyse = sc.textFile("/user/bbastola/nyse")

from pyspark.sql import Row
nyseDF = nyse.map(lambda r: Row(stockticker=r.split(",")[0], transactiondate=r.split(",")[1], openprice=float(r.split(",")[2]), highprice=float(r.split(",")[3]), lowprice=float(r.split(",")[4]), closeprice=float(r.split(",")[5]), volume=int(r.split(",")[6]))).toDF()

nyseDF.coalesce(1).write.parquet("/user/bbastola/nyse_parquet")

validation

nyseParquet = sqlContext.read.parquet("/user/bbastola/nyse_parquet")
nyseParquet.printSchema()

