(stockticker:string, transactiondate:string, openprice:float, highprice:float, lowprice:float, closeprice:float, volume:bigint)

// top 5 closing price per stock of all time

nyseRDD = sc.textFile("/public/nyse")

nyseMap = nyseRDD.map(lambda x: (x.split(",")[0], x))

nyseMapGroupBy = nyseMap.groupByKey()


nyseSorted = nyseMapGroupBy.flatMap(lambda rec: sorted(rec[1], key=lambda i: float(i.split(",")[5]), reverse=True)[:5])


//








