Problem 4 - Part 3

Transform/Convert data-files at /user/cloudera/problem5/avro-snappy and store the converted file at the following locations and file formats

save the data to hdfs using no compression as json file at /user/cloudera/problem5/json-no-compress

snappyAvro = sqlContext.read.format("com.databricks.spark.avro").load("/user/cloudera/problem5/avro-snappy")
sqlContext.setConf("spark.sql.json.compression.codec", "uncompressed")
snappyAvro.toJSON().saveAsTextFile("/user/cloudera/problem5/json-no-compress")

save the data to hdfs using gzip compression as json file at /user/cloudera/problem5/json-gzip
sqlContext.setConf("spark.sql.JSON.compression.codec", "Gzip")
snappyAvro.toJSON().saveAsTextFile("/user/cloudera/problem5/json-gzip", "org.apache.hadoop.io.compress.GzipCodec")

